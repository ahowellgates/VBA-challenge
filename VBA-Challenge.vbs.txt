      Sub stock_data()         Dim ticker As String         Dim yearly_change As Double         Dim first_day As Double         Dim last_day As Double         Dim open_day As Double         Dim close_day As Double                  Dim last_row As LongLong                  lastrow = Cells(Rows.Count, 1).End(xlUp).Row                  first_day = Application.WorksheetFunction.Min(Range("B:B").Value)                  last_day = Application.WorksheetFunction.Min(Range("B:B").Value)                  Dim Summary_Table_Row As Double            Summary_Table_Row = 2                For I = 2 To lastrow                If Cells(I + 1, 1).Value <> Cells(I, 1).Value Then                    ticker = Cells(I, 1).Value                If first_day = Cells(I, 2).Value Then                open_day = Cells(I, 3).Value                ElseIf last_day = Cells(I, 2).Value Then                close_day = Cells(I, 6).Value                                End If                        yearly_change = (close_day - open_day)                Range("K" & Summary_Table_Row).Value = ticker        Range("K" & Summary_Table_Row).Value = yearly_change        Range("M" & Summary_Table_Row).Value = open_day        Range("N" & Summary_Table_Row).Value = close_day                Summary_Table_Row = Summary_Table_Row = 1                                       Else              If first_day = Cells(I, 2).Value Then       open_day = Cells(I, 3).Value       ElseIf last_day = Cells(I, 2).Value Then       close_day = Cells(I, 6).Value              End If              End If              Next I                     End Sub